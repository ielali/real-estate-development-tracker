# Story 10.15: Content Layout Fix - Remove Container Centering

## Status

**Current Status:** todo

## User Story

As a **user**,
I want **content to expand and fill available space when the sidebar collapses**,
So that **I can utilize the full screen width for my work**.

## Story Context

**Existing System Integration:**

- Integrates with: ContentWrapper (Story 10.9), all page components
- Technology: Tailwind CSS, custom layouts
- Follows pattern: Replace `.container` class with explicit padding/max-width
- Touch points: ~50 page files across app directory
- Reference: `docs/design/CONTENT_CENTERING_ISSUE.md`

**Problem Statement:**

When the sidebar collapses from 256px to 64px, the `ContentWrapper` correctly adjusts the `margin-left` via animation. However, **all pages use the `.container` class** which has `margin: 0 auto` (centers content), causing the content to remain centered instead of expanding to fill the available space.

**Target Behavior:**

Content should have consistent padding on both sides and expand to fill the available width (up to a max-width), not center itself with equal margins.

## Acceptance Criteria

**Functional Requirements:**

1. Content expands to fill available width when sidebar collapses
2. Content maintains consistent horizontal padding (px-6 = 24px)
3. Content respects maximum width constraints where appropriate
4. Auth pages (login, register) remain centered (intentional design)
5. Error pages remain centered (intentional design)

**Integration Requirements:**

6. `.container` class removed from all main application pages
7. PageContainer component created as helper (optional)
8. Tailwind container config updated or usage documented
9. No horizontal scroll on any screen size

**Quality Requirements:**

10. Responsive behavior correct on all screen sizes (mobile, tablet, desktop)
11. Content doesn't feel cramped or too wide
12. Visual consistency maintained across pages
13. No layout breaks or content reflow issues

## Tasks / Subtasks

### Phase 1: Create PageContainer Component

- [ ] Task 1: Create PageContainer helper component (AC: 7)
  - [ ] Create file: `components/layout/PageContainer.tsx`
  - [ ] Define props: children, maxWidth, className
  - [ ] Implement padding: px-6 py-6
  - [ ] Implement max-width variants:
    - sm: 640px
    - md: 768px
    - lg: 1024px
    - xl: 1280px
    - 2xl: 1536px
    - 4xl: 1792px
    - 7xl: 2560px
    - full: no max-width
  - [ ] Add JSDoc documentation
  - [ ] Export from components/layout

### Phase 2: Audit Current Container Usage

- [ ] Task 2: Document all container usage (AC: 6)
  - [ ] List all pages using `.container mx-auto`
  - [ ] Categorize by max-width needs:
    - Forms: max-w-2xl (672px)
    - Details: max-w-4xl (896px)
    - Lists/Tables: max-w-7xl (1280px)
    - Full-width: max-w-none
  - [ ] Identify special cases (auth, error pages)
  - [ ] Create migration checklist

### Phase 3: Update High-Priority Pages

- [ ] Task 3: Update dashboard page (AC: 1,2,3)
  - [ ] Replace: `container mx-auto` → `px-6 py-6 max-w-7xl`
  - [ ] Test sidebar collapse (content expands)
  - [ ] Test responsive behavior
  - [ ] Verify no horizontal scroll

- [ ] Task 4: Update project pages (AC: 1,2,3)
  - [ ] Projects list (`app/projects/page.tsx`)
  - [ ] Project detail (`app/projects/[id]/page.tsx`)
  - [ ] Project costs (`app/projects/[id]/costs/page.tsx`)
  - [ ] Test sidebar collapse on each page
  - [ ] Verify tables fill available width

- [ ] Task 5: Update vendor pages (AC: 1,2,3)
  - [ ] Vendor dashboard (`app/vendors/dashboard/page.tsx`)
  - [ ] Vendor detail (`app/vendors/[id]/page.tsx`)
  - [ ] Test sidebar collapse
  - [ ] Verify list items expand

### Phase 4: Update Medium-Priority Pages

- [ ] Task 6: Update contacts pages (AC: 1,2,3)
  - [ ] Contacts list (`app/contacts/page.tsx`)
  - [ ] Contact detail (`app/contacts/[id]/page.tsx`)
  - [ ] Use max-w-7xl for lists
  - [ ] Test responsive behavior

- [ ] Task 7: Update portfolio and categories (AC: 1,2,3)
  - [ ] Portfolio page (`app/portfolio/page.tsx`)
  - [ ] Categories page (`app/categories/page.tsx`)
  - [ ] Test with sidebar collapse
  - [ ] Verify chart/visual components scale correctly

### Phase 5: Update Form Pages

- [ ] Task 8: Update form pages with narrower width (AC: 2,3)
  - [ ] New project (`app/projects/new/page.tsx`) → max-w-2xl
  - [ ] Edit project (`app/projects/[id]/edit/page.tsx`) → max-w-2xl
  - [ ] New cost (`app/projects/[id]/costs/new/page.tsx`) → max-w-2xl
  - [ ] Edit cost (`app/projects/[id]/costs/[costId]/edit/page.tsx`) → max-w-2xl
  - [ ] Forms should be narrower, not full-width

### Phase 6: Handle Special Cases

- [ ] Task 9: Preserve centering for auth pages (AC: 4)
  - [ ] Login page: Keep centered layout
  - [ ] Register page: Keep centered layout
  - [ ] Reset password: Keep centered layout
  - [ ] Forgot password: Keep centered layout
  - [ ] 2FA verify: Keep centered layout
  - [ ] Use pattern:
    ```tsx
    <div className="min-h-screen flex items-center justify-center">
      <div className="max-w-md w-full px-6">{/* form */}</div>
    </div>
    ```

- [ ] Task 10: Preserve centering for error pages (AC: 5)
  - [ ] 404 page: Keep centered
  - [ ] 500 page: Keep centered
  - [ ] Other error pages: Keep centered

### Phase 7: Update Settings Pages

- [ ] Task 11: Update settings pages (AC: 1,2,3)
  - [ ] Settings main (`app/settings/page.tsx`)
  - [ ] Notifications (`app/settings/notifications/page.tsx`)
  - [ ] Security pages (`app/settings/security/**`)
  - [ ] Settings has nested layout, update container there

### Phase 8: Update Remaining Pages

- [ ] Task 12: Update all remaining pages (AC: 1,2,3,6)
  - [ ] Project events pages
  - [ ] Project documents pages
  - [ ] Project partners pages
  - [ ] Project settings pages
  - [ ] Vendor compare page
  - [ ] Admin pages
  - [ ] Any other pages with container

### Phase 9: Remove/Update Tailwind Config

- [ ] Task 13: Update Tailwind container config (AC: 8)
  - [ ] Option A: Remove `center: true` from config
  - [ ] Option B: Keep config, document usage guidelines
  - [ ] Document: "Don't use `.container` for app pages"
  - [ ] Update ESLint rule to warn on `.container mx-auto` usage

### Phase 10: Testing & Validation

- [ ] Task 14: Test sidebar collapse on all pages (AC: 1)
  - [ ] Expand sidebar: Content has consistent padding
  - [ ] Collapse sidebar: Content expands to fill space
  - [ ] Test on dashboard
  - [ ] Test on project pages
  - [ ] Test on vendor pages
  - [ ] Test on contacts pages
  - [ ] Test on settings pages
  - [ ] Document any issues

- [ ] Task 15: Test responsive behavior (AC: 9,10)
  - [ ] Test on mobile (320px - 768px)
  - [ ] Test on tablet (768px - 1024px)
  - [ ] Test on desktop (1024px - 1920px)
  - [ ] Test on large desktop (1920px+)
  - [ ] Verify no horizontal scroll
  - [ ] Check touch target sizes on mobile

- [ ] Task 16: Visual consistency check (AC: 11,12,13)
  - [ ] Compare before/after screenshots
  - [ ] Verify padding consistent across pages
  - [ ] Check max-widths appropriate for content
  - [ ] Ensure no pages feel cramped or too wide
  - [ ] Test with real content/data

### Phase 11: Documentation

- [ ] Task 17: Update documentation
  - [ ] Document new layout pattern
  - [ ] Add PageContainer usage examples
  - [ ] Create layout guidelines for new pages
  - [ ] Document when to use each max-width
  - [ ] Add migration guide for future pages

## Dev Notes

### Implementation Approach

Replace `.container mx-auto` pattern with explicit padding and max-width:

**Before:**

```tsx
<div className="container mx-auto p-6">{/* content */}</div>
```

**After (Option 1 - Direct classes):**

```tsx
<div className="px-6 py-6 max-w-7xl">{/* content */}</div>
```

**After (Option 2 - PageContainer component):**

```tsx
<PageContainer maxWidth="7xl">{/* content */}</PageContainer>
```

### PageContainer Component

```tsx
// components/layout/PageContainer.tsx
import { ReactNode } from "react"
import { cn } from "@/lib/utils"

type MaxWidth = "sm" | "md" | "lg" | "xl" | "2xl" | "4xl" | "7xl" | "full"

interface PageContainerProps {
  children: ReactNode
  maxWidth?: MaxWidth
  className?: string
}

const maxWidthClasses: Record<MaxWidth, string> = {
  sm: "max-w-sm",       // 640px - narrow forms
  md: "max-w-md",       // 768px - medium forms
  lg: "max-w-lg",       // 1024px - reading content
  xl: "max-w-xl",       // 1280px - wider content
  "2xl": "max-w-2xl",   // 1536px - forms, details
  "4xl": "max-w-4xl",   // 1792px - detail pages
  "7xl": "max-w-7xl",   // 2560px - lists, tables
  full: "max-w-none",   // no limit - full width
}

/**
 * PageContainer - Standard page content wrapper
 *
 * Provides consistent padding and optional max-width constraints.
 * Content expands to fill available width (not centered).
 *
 * @example
 * <PageContainer maxWidth="7xl">
 *   <h1>Dashboard</h1>
 *   {/* content */}
 * </PageContainer>
 */
export function PageContainer({
  children,
  maxWidth = "7xl",
  className,
}: PageContainerProps) {
  return (
    <div className={cn("px-6 py-6", maxWidthClasses[maxWidth], className)}>
      {children}
    </div>
  )
}
```

### Max-Width Guidelines

Use appropriate max-width for content type:

- **Forms (sm-2xl):** 640px - 1536px
  - Login, registration, settings forms
  - New/edit pages (projects, costs, contacts)
  - Narrow content for better readability

- **Detail Pages (4xl):** 1792px
  - Project detail
  - Contact detail
  - Vendor detail
  - Moderate width for content + sidebar

- **Lists/Tables (7xl):** 2560px
  - Dashboard
  - Project list
  - Vendor dashboard
  - Tables need horizontal space

- **Full Width (full):** No max-width
  - Charts, graphs
  - Maps
  - Image galleries
  - Use sparingly

### Migration Checklist Template

For each page:

1. ✅ Identify current container usage
2. ✅ Determine appropriate max-width
3. ✅ Replace with PageContainer or direct classes
4. ✅ Test sidebar collapse (content expands)
5. ✅ Test responsive behavior (mobile, tablet, desktop)
6. ✅ Verify no horizontal scroll
7. ✅ Check visual spacing consistency

### Pages by Priority

**High Priority (Test these first):**

- Dashboard (`app/page.tsx`)
- Projects list (`app/projects/page.tsx`)
- Project detail (`app/projects/[id]/page.tsx`)
- Project costs (`app/projects/[id]/costs/page.tsx`)

**Medium Priority:**

- Contacts, Portfolio, Categories
- Vendor pages
- Settings pages

**Low Priority (Special cases):**

- Auth pages (keep centered)
- Error pages (keep centered)
- Admin pages (test last)

### Testing Standards

- Test sidebar collapse on each updated page
- Screenshot before/after for comparison
- Verify no horizontal scroll (use Chrome DevTools responsive mode)
- Test on real devices if possible
- Check with various content lengths (empty, partial, full)

## Definition of Done

- [ ] PageContainer component created
- [ ] All main application pages updated (no `.container mx-auto`)
- [ ] Dashboard content expands with sidebar collapse
- [ ] Project pages content expands with sidebar collapse
- [ ] Auth pages remain centered (intentional)
- [ ] Error pages remain centered (intentional)
- [ ] No horizontal scroll on any page
- [ ] Responsive behavior correct (mobile, tablet, desktop)
- [ ] Content padding consistent (px-6)
- [ ] Max-widths appropriate for content type
- [ ] Visual consistency maintained
- [ ] No layout breaks or reflow issues
- [ ] Tailwind config updated or documented
- [ ] Documentation updated with new pattern
- [ ] Tests pass (visual regression)
- [ ] Build succeeds with no errors
- [ ] Code reviewed and approved
- [ ] Story status updated to "Done"

## Risk and Compatibility Check

**Minimal Risk Assessment:**

- **Primary Risk:** Changing 50+ pages may introduce layout issues
- **Mitigation:** Test each page, incremental rollout, visual regression tests
- **Rollback:** Revert specific pages or full PR if major issues

**Compatibility Verification:**

- [ ] No pages with horizontal scroll
- [ ] Content doesn't feel too wide or cramped
- [ ] Tables fill available width appropriately
- [ ] Forms remain readable (not too wide)
- [ ] Mobile layout not affected
- [ ] Sidebar collapse animation smooth
- [ ] No content reflow during animation

## Validation Checklist

**Scope Validation:**

- [x] Story requires systematic page updates (2-3 hours)
- [x] Integration approach is straightforward (replace classes)
- [x] Follows best practices (explicit layout, no auto-centering)
- [x] No backend changes required

**Clarity Check:**

- [x] Story requirements are clear (remove container centering)
- [x] Integration points are well-defined (all page files)
- [x] Success criteria are testable (sidebar collapse, no scroll)
- [x] Rollback approach exists (revert changes)

---

## Change Log

| Date         | Version | Description            | Author    |
| ------------ | ------- | ---------------------- | --------- |
| Nov 12, 2025 | 1.0     | Initial story creation | Dev Agent |

---

## Dev Agent Record

_To be populated during implementation_

---

## QA Results

_To be populated after QA review_

---

**Story Status:** Approved
**Estimated Effort:** 2-3 hours
**Dependencies:** Story 10.9 (ContentWrapper), all pages migrated
**Epic:** EPIC-10.2 - Design Alignment with Target Specification
**Created:** November 12, 2025
**Last Updated:** November 12, 2025

---

## Quick Start Guide

**Fastest implementation approach:**

1. Create PageContainer component (5 min)
2. Update dashboard page to test (2 min)
3. Test sidebar collapse - verify content expands (1 min)
4. If working, batch update remaining pages (1-2 hours)
5. Test each page category (30 min)

**Use find/replace for speed:**

```bash
# Find pages with container
rg "container mx-auto" apps/web/src/app --files-with-matches

# Batch replace (review each file)
# container mx-auto p-6 → px-6 py-6 max-w-7xl
```
